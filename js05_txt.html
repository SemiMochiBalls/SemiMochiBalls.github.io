"use strict";
/*    JavaScript 7th Edition
      Chapter 5
      Chapter Case

      Application to generate a slide show
      Author: Sabijon Reyes 
      Date:   6/19/2023

      Filename: js05.js
*/
// Add a listener to set up the gallery once the window is loaded
window.addEventListener("load", createLightbox);
// Array to hold favorite pictures

let favoritePictures = [];
let errorOverlay = null;
// Function to add a picture to favorites

function addToFavorites(picture) {
    // Restrict favorites to three pictures max

   if (favoritePictures.length >= 3) {
       console.log("Cannot add more than three pictures to favorites.");
       displayErrorMessage("Cannot add more than three pictures to favorites.");
       return;
   }
    // Avoid duplication in favorites
   if (favoritePictures.includes(picture)) {
       console.log("Image is already in favorites list.");
       displayErrorMessage("Image is already in favorites list.");
       return;
   }
    // Add the picture to favorites
   favoritePictures.push(picture);
   console.log("Added to favorites:", picture);
   displayFavorites();
}
// Function to display an error message to the user
function displayErrorMessage(message) {
   // Create the popup overlay element
   let overlay = document.createElement("div");
   overlay.classList.add("popup-overlay");

   // Create the error message container
   let errorMessage = document.createElement("div");
   errorMessage.classList.add("error-message");
   errorMessage.textContent = message;

   // Create the close button
   let closeButton = document.createElement("span");
   closeButton.classList.add("close-button");
   closeButton.innerHTML = "&times;";
   closeButton.addEventListener("click", function () {
       overlay.remove();
   });

   // Append the error message and close button to the overlay
   overlay.appendChild(errorMessage);
   overlay.appendChild(closeButton);

   // Append the overlay to the document body
   document.body.appendChild(overlay);
}
// Function to create a lightbox for displaying images
function createLightbox() {
    // Lightbox Container
    let lightBox = document.getElementById("lightbox");

    // Parts of the lightbox
    let lbTitle = document.createElement("h1");
    let lbCounter = document.createElement("div");
    let lbPrev = document.createElement("div");
    let lbNext = document.createElement("div");
    let lbPlay = document.createElement("div");
    let lbImages = document.createElement("div");
    let slidesTitle = "My Slideshow";

    lightBox.appendChild(lbTitle);
    lbTitle.id = "lbTitle";
    lbTitle.textContent = lightboxTitle;
    lightBox.appendChild(lbCounter);
    lbCounter.id = "lbCounter";
    let currentImg = 1;
    lbCounter.textContent = currentImg + " / " + imgCount;
    lightBox.appendChild(lbPrev);
    lbPrev.id = "lbPrev";
    lbPrev.innerHTML = "&#9664;";
    lbPrev.onclick = showPrev;
    lightBox.appendChild(lbNext);
    lbNext.id = "lbNext";
    lbNext.innerHTML = "&#9654;";
    lbNext.onclick = showNext;
    lightBox.appendChild(lbPlay);
    lbPlay.id = "lbPlay";
    lbPlay.innerHTML = "&#9199;";
    let timeID;
    lbPlay.onclick = function () {
        if (timeID) {
            // Stop the slideshow
            window.clearInterval(timeID);
            timeID = undefined;
        } else {
            // Start the slideshow
            showNext();
            timeID = window.setInterval(showNext, 1500);
        }
    }

    // Design the lightbox images container
    lightBox.appendChild(lbImages);
    lbImages.id = "lbImages";

    // Add images from the imgFiles array to the container
    for (let i = 0; i < imgCount; i++) {
        let image = document.createElement("img");
        image.src = imgFiles[i];
        image.alt = imgCaptions[i];
        image.onclick = createOverlay;
        lbImages.appendChild(image);
    }

    // Function to move forward through the image list
    function showNext() {
        lbImages.appendChild(lbImages.firstElementChild);
        (currentImg < imgCount) ? currentImg++ : currentImg = 1;
        lbCounter.textContent = currentImg + " / " + imgCount;
    }

    // Function to move backward through the image list
    function showPrev() {
        lbImages.insertBefore(lbImages.lastElementChild, lbImages.firstElementChild);
        (currentImg > 1) ? currentImg-- : currentImg = imgCount;
        lbCounter.textContent = currentImg + " / " + imgCount;
    }
function displayFavorites() {
  let favoritesList = document.getElementById("favoritesList");

  // Clear the previous content of the favorites list
  favoritesList.innerHTML = "";

  for (let i = 0; i < favoritePictures.length; i++) {
    let imgElement = document.createElement("img");
    imgElement.src = favoritePictures[i];
    imgElement.alt = "Favorite Picture";

    let removeButton = document.createElement("button");
    removeButton.textContent = "Remove";
    removeButton.classList.add("remove-button"); // Add the CSS class for styling
    removeButton.addEventListener("click", function () {
      removeFavorite(i);
    });

    let listItem = document.createElement("li");
    listItem.appendChild(imgElement);
    listItem.appendChild(removeButton);
    favoritesList.appendChild(listItem);
  }
}

  // Function to remove a picture from favorites
  function removeFavorite(index) {
      favoritePictures.splice(index, 1);
      displayFavorites();
  }
      function createOverlay() {
      for (let i = 0; i < favoritePictures.length; i++) {
          let listItem = document.createElement("li");
          listItem.textContent = favoritePictures[i];
          favoritesList.appendChild(listItem);
      }
  }
  // Function to create an overlay for displaying a picture
    function createOverlay() {
        let overlay = document.createElement("div");
        overlay.id = "lbOverlay";

        // Add the figure box to the overlay
        let figureBox = document.createElement("figure");
        overlay.appendChild(figureBox);

        // Add the image to the figure box
        let overlayImage = this.cloneNode(true);
        figureBox.appendChild(overlayImage);

        // Add the caption to the figure box
        let overlayCaption = document.createElement("figcaption");
        overlayCaption.textContent = this.alt;
        figureBox.appendChild(overlayCaption);

        // Add a close button to the overlay
        let closeBox = document.createElement("div");
        closeBox.id = "lbOverlayClose";
        closeBox.innerHTML = "&times;";
        closeBox.onclick = function () {
            document.body.removeChild(overlay);
        };
        overlay.appendChild(closeBox);

        // Add an add to favorites button to the overlay
               let addFavoriteBox = document.createElement("div");
               addFavoriteBox.id = "lbAddFavorite";
               addFavoriteBox.textContent = "Add to Favorites";
               addFavoriteBox.onclick = function (event) {
                  event.preventDefault(); 
                  event.stopPropagation(); 
                  addToFavorites(overlayImage.src); 
                  displayFavorites();
              };
              
        overlay.appendChild(addFavoriteBox);
        document.body.appendChild(overlay);
    }
}

window.addEventListener("load", setupGallery);
// Function to set up the image gallery
// Setup function for the gallery
function setupGallery() {
    // Get the number of images from global array
    let imageCount = imgFiles.length;

    // Get reference to gallery DOM element
    let galleryBox = document.getElementById("gallery");

    // Initialize current slide and run show control variables
    let currentSlide = 1;
    let runShow = true;
    let showRunning;

    // Create and append the gallery title to the gallery box
    let galleryTitle = document.createElement("h1");
    galleryTitle.id = "galleryTitle";
    galleryTitle.textContent = slidesTitle;
    galleryBox.appendChild(galleryTitle);

    // Create and append the slide counter to the gallery box
    let slideCounter = document.createElement("div");
    slideCounter.id = "slideCounter";
    slideCounter.textContent = currentSlide + "/" + imageCount;
    galleryBox.appendChild(slideCounter);

    // Create, configure and append the left navigation box
    let leftBox = document.createElement("div");
    leftBox.id = "leftBox";
    leftBox.innerHTML = "&#9664;"; // Left arrow character
    leftBox.onclick = moveToLeft;
    galleryBox.appendChild(leftBox);

    // Create, configure and append the right navigation box
    let rightBox = document.createElement("div");
    rightBox.id = "rightBox";
    rightBox.innerHTML = "&#9654;"; // Right arrow character
    rightBox.onclick = moveToRight;
    galleryBox.appendChild(rightBox);

    // Create, configure and append the play-pause control
    let playPause = document.createElement("div");
    playPause.id = "playPause";
    playPause.innerHTML = "&#9199;"; // Play-pause character
    playPause.onclick = startStopShow;
    galleryBox.appendChild(playPause);

    // Create and append the slide box (image container)
    let slideBox = document.createElement("div");
    slideBox.id = "slideBox";
    galleryBox.appendChild(slideBox);

    // Add all images to the slide box
    for (let i = 0; i < imageCount; i++) {
        let image = document.createElement("img");
        image.src = imgFiles[i];
        image.alt = imgCaptions[i];
        image.onclick = createModal;
        slideBox.appendChild(image);
    }

    // Move the gallery to the right
    function moveToRight() {
        // Clone the first image and append it to the end
        let firstImage = slideBox.firstElementChild.cloneNode(true);
        firstImage.onclick = createModal;
        slideBox.appendChild(firstImage);

        // Remove the first image
        slideBox.removeChild(slideBox.firstElementChild);

        // Update slide counter
        currentSlide++;
        if (currentSlide > imageCount) {
            currentSlide = 1;
        }
        slideCounter.textContent = currentSlide + " / " + imageCount;
    }

    // Move the gallery to the left
    function moveToLeft() {
        // Clone the last image and insert it at the beginning
        let lastImage = slideBox.lastElementChild.cloneNode(true);
        lastImage.onclick = createModal;
        slideBox.removeChild(slideBox.lastElementChild);
        slideBox.insertBefore(lastImage, slideBox.firstElementChild);

        // Update slide counter
        currentSlide--;
        if (currentSlide === 0) {
            currentSlide = imageCount;
        }
        slideCounter.textContent = currentSlide + " / " + imageCount;
    }

    // Start or stop the automatic gallery show
    function startStopShow() {
        if (runShow) {
            showRunning = window.setInterval(moveToRight, 2000); // Start automatic slide show
            runShow = false;
        } else {
            window.clearInterval(showRunning); // Stop automatic slide show
            runShow = true;
        }
    }

    // Create a modal window to display an image
    function createModal() {
        // Create modal window and related elements
        let modalWindow = document.createElement("div");
        modalWindow.id = "activeModal";
        let figureBox = document.createElement("figure");
        modalWindow.appendChild(figureBox);

        // Clone and append the clicked image to the modal window
        let modalImage = this.cloneNode(true);
        figureBox.appendChild(modalImage);

        // Create and append image caption to the modal window
        let figureCaption = document.createElement("figcaption");
        figureCaption.textContent = modalImage.alt;
        figureBox.appendChild(figureCaption);

        // Create and append close button to the modal window
        let closeBox = document.createElement("div");
        closeBox.id = "modalClose";
        closeBox.innerHTML = "&times;"; // Close button character
        closeBox.onclick = function () {
            document.body.removeChild(modalWindow); // Remove modal window on close button click
        }

        modalWindow.appendChild(closeBox);

        // Add modal window to the document body
        document.body.appendChild(modalWindow);
    }
}
// Setup function for the gallery
function setupGallery() {
    // Get the number of images from global array
    let imageCount = imgFiles.length;

    // Get reference to gallery DOM element
    let galleryBox = document.getElementById("gallery");

    // Initialize current slide and run show control variables
    let currentSlide = 1;
    let runShow = true;
    let showRunning;

    // Create and append the gallery title to the gallery box
    let galleryTitle = document.createElement("h1");
    galleryTitle.id = "galleryTitle";
    galleryTitle.textContent = slidesTitle;
    galleryBox.appendChild(galleryTitle);

    // Create and append the slide counter to the gallery box
    let slideCounter = document.createElement("div");
    slideCounter.id = "slideCounter";
    slideCounter.textContent = currentSlide + "/" + imageCount;
    galleryBox.appendChild(slideCounter);

    // Create, configure and append the left navigation box
    let leftBox = document.createElement("div");
    leftBox.id = "leftBox";
    leftBox.innerHTML = "&#9664;"; // Left arrow character
    leftBox.onclick = moveToLeft;
    galleryBox.appendChild(leftBox);

    // Create, configure and append the right navigation box
    let rightBox = document.createElement("div");
    rightBox.id = "rightBox";
    rightBox.innerHTML = "&#9654;"; // Right arrow character
    rightBox.onclick = moveToRight;
    galleryBox.appendChild(rightBox);

    // Create, configure and append the play-pause control
    let playPause = document.createElement("div");
    playPause.id = "playPause";
    playPause.innerHTML = "&#9199;"; // Play-pause character
    playPause.onclick = startStopShow;
    galleryBox.appendChild(playPause);

    // Create and append the slide box (image container)
    let slideBox = document.createElement("div");
    slideBox.id = "slideBox";
    galleryBox.appendChild(slideBox);

    // Add all images to the slide box
    for (let i = 0; i < imageCount; i++) {
        let image = document.createElement("img");
        image.src = imgFiles[i];
        image.alt = imgCaptions[i];
        image.onclick = createModal;
        slideBox.appendChild(image);
    }

    // Move the gallery to the right
    function moveToRight() {
        // Clone the first image and append it to the end
        let firstImage = slideBox.firstElementChild.cloneNode(true);
        firstImage.onclick = createModal;
        slideBox.appendChild(firstImage);

        // Remove the first image
        slideBox.removeChild(slideBox.firstElementChild);

        // Update slide counter
        currentSlide++;
        if (currentSlide > imageCount) {
            currentSlide = 1;
        }
        slideCounter.textContent = currentSlide + " / " + imageCount;
    }

    // Move the gallery to the left
    function moveToLeft() {
        // Clone the last image and insert it at the beginning
        let lastImage = slideBox.lastElementChild.cloneNode(true);
        lastImage.onclick = createModal;
        slideBox.removeChild(slideBox.lastElementChild);
        slideBox.insertBefore(lastImage, slideBox.firstElementChild);

        // Update slide counter
        currentSlide--;
        if (currentSlide === 0) {
            currentSlide = imageCount;
        }
        slideCounter.textContent = currentSlide + " / " + imageCount;
    }

    // Start or stop the automatic gallery show
    function startStopShow() {
        if (runShow) {
            showRunning = window.setInterval(moveToRight, 2000); // Start automatic slide show
            runShow = false;
        } else {
            window.clearInterval(showRunning); // Stop automatic slide show
            runShow = true;
        }
    }

    // Create a modal window to display an image
    function createModal() {
        // Create modal window and related elements
        let modalWindow = document.createElement("div");
        modalWindow.id = "activeModal";
        let figureBox = document.createElement("figure");
        modalWindow.appendChild(figureBox);

        // Clone and append the clicked image to the modal window
        let modalImage = this.cloneNode(true);
        figureBox.appendChild(modalImage);

        // Create and append image caption to the modal window
        let figureCaption = document.createElement("figcaption");
        figureCaption.textContent = modalImage.alt;
        figureBox.appendChild(figureCaption);

        // Create and append close button to the modal window
        let closeBox = document.createElement("div");
        closeBox.id = "modalClose";
        closeBox.innerHTML = "&times;"; // Close button character
        closeBox.onclick = function () {
            document.body.removeChild(modalWindow); // Remove modal window on close button click
        }

        modalWindow.appendChild(closeBox);

        // Add modal window to the document body
        document.body.appendChild(modalWindow);
    }
}
